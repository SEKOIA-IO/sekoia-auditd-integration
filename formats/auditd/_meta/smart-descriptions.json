[
  {
    "value": "User authentication via SSH: {user.name} authenticated successfully from {source.ip} on {host.name}",
    "conditions": [
      {
        "field": "event.type",
        "value": "cred_acq"
      },
      {
        "field": "event.action",
        "value": "PAM:setcred"
      },
      {
        "field": "action.outcome",
        "value": "success"
      },
      {
        "field": "user.name"
      },
      {
        "field": "source.ip"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.name",
        "type": "authenticated on"
      },
      {
        "source": "source.ip",
        "target": "host.name",
        "type": "connected to"
      }
    ]
  },
  {
    "value": "User authentication via SSH: {user.name} authenticated successfully on {host.name}",
    "conditions": [
      {
        "field": "event.type",
        "value": "cred_acq"
      },
      {
        "field": "event.action",
        "value": "PAM:setcred"
      },
      {
        "field": "action.outcome",
        "value": "success"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.name",
        "type": "authenticated on"
      }
    ]
  },
  {
    "value": "Authentication failure: User {user.name} failed to authenticate from {source.ip} on {host.name}",
    "conditions": [
      {
        "field": "event.type",
        "value": "cred_acq"
      },
      {
        "field": "action.outcome",
        "value": "failure"
      },
      {
        "field": "user.name"
      },
      {
        "field": "source.ip"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.name",
        "type": "failed to authenticate on"
      },
      {
        "source": "source.ip",
        "target": "host.name",
        "type": "attempted connection to"
      }
    ]
  },
  {
    "value": "Encrypted SSH session established from {source.ip}:{source.port} to {destination.ip}:{destination.port} on {host.name} using cipher {tls.cipher}",
    "conditions": [
      {
        "field": "event.type",
        "value": "crypto_session"
      },
      {
        "field": "event.action",
        "value": "start"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "destination.ip"
      },
      {
        "field": "tls.cipher"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "established encrypted session with"
      },
      {
        "source": "process.executable",
        "target": "host.name",
        "type": "handled connection on"
      }
    ]
  },
  {
    "value": "Encrypted session initiated on {host.name} using {tls.cipher} ({tls.client.x509.public_key_size}-bit key)",
    "conditions": [
      {
        "field": "event.type",
        "value": "crypto_session"
      },
      {
        "field": "event.action",
        "value": "start"
      },
      {
        "field": "tls.cipher"
      }
    ],
    "relationships": [
      {
        "source": "process.executable",
        "target": "host.name",
        "type": "initiated encrypted session on"
      }
    ]
  },
  {
    "value": "File system access: {file.path} accessed on {host.name} (inode: {file.inode})",
    "conditions": [
      {
        "field": "event.type",
        "value": "path"
      },
      {
        "field": "file.path"
      },
      {
        "field": "file.inode"
      }
    ],
    "relationships": [
      {
        "source": "user.id",
        "target": "file.path",
        "type": "accessed"
      }
    ]
  },
  {
    "value": "File system activity on {host.name}: {file.path}",
    "conditions": [
      {
        "field": "event.type",
        "value": "path"
      },
      {
        "field": "file.path"
      }
    ],
    "relationships": [
      {
        "source": "user.id",
        "target": "file.path",
        "type": "interacted with"
      }
    ]
  },
  {
    "value": "Process {process.executable} (PID: {process.pid}) executed by user {user.name} on {host.name}",
    "conditions": [
      {
        "field": "process.executable"
      },
      {
        "field": "process.pid"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "process.executable",
        "type": "executed"
      },
      {
        "source": "process.executable",
        "target": "host.name",
        "type": "ran on"
      }
    ]
  },
  {
    "value": "Process {process.executable} (PID: {process.pid}) executed on {host.name}",
    "conditions": [
      {
        "field": "process.executable"
      },
      {
        "field": "process.pid"
      }
    ],
    "relationships": [
      {
        "source": "process.executable",
        "target": "host.name",
        "type": "ran on"
      }
    ]
  },
  {
    "value": "User session activity: {user.name} performed {event.action} operation on {host.name}",
    "conditions": [
      {
        "field": "event.action"
      },
      {
        "field": "user.name"
      },
      {
        "field": "action.outcome",
        "value": "success"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.name",
        "type": "performed operation on"
      }
    ]
  },
  {
    "value": "Failed operation: {user.name} attempted {event.action} on {host.name} (result: {action.outcome})",
    "conditions": [
      {
        "field": "event.action"
      },
      {
        "field": "user.name"
      },
      {
        "field": "action.outcome",
        "value": "failure"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.name",
        "type": "attempted operation on"
      }
    ]
  },
  {
    "value": "Credential acquisition successful: {event.provider} granted credentials for {user.name} on {host.name}",
    "conditions": [
      {
        "field": "event.type",
        "value": "cred_acq"
      },
      {
        "field": "event.provider"
      },
      {
        "field": "user.name"
      },
      {
        "field": "action.outcome",
        "value": "success"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.name",
        "type": "acquired credentials on"
      }
    ]
  },
  {
    "value": "Credential disposal: Credentials released for user {user.name} on {host.name}",
    "conditions": [
      {
        "field": "event.type",
        "value": "cred_disp"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.name",
        "type": "released credentials on"
      }
    ]
  },
  {
    "value": "User session started: {user.name} initiated session from {source.domain} ({source.ip}) on {host.name} using {service.name}",
    "conditions": [
      {
        "field": "event.type",
        "value": "user_start"
      },
      {
        "field": "user.name"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "source.domain"
      },
      {
        "field": "service.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.name",
        "type": "started session on"
      },
      {
        "source": "source.ip",
        "target": "host.name",
        "type": "connected to"
      }
    ]
  },
  {
    "value": "User session started: {user.name} initiated session on {host.name}",
    "conditions": [
      {
        "field": "event.type",
        "value": "user_start"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.name",
        "type": "started session on"
      }
    ]
  },
  {
    "value": "User session ended: {user.name} terminated session on {host.name}",
    "conditions": [
      {
        "field": "event.type",
        "value": "user_end"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.name",
        "type": "ended session on"
      }
    ]
  },
  {
    "value": "User login: {user.name} logged in from {source.ip} on {host.name}",
    "conditions": [
      {
        "field": "event.type",
        "value": "user_login"
      },
      {
        "field": "user.name"
      },
      {
        "field": "source.ip"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.name",
        "type": "logged in on"
      },
      {
        "source": "source.ip",
        "target": "host.name",
        "type": "originated login to"
      }
    ]
  },
  {
    "value": "User logout: {user.name} logged out from {host.name}",
    "conditions": [
      {
        "field": "event.type",
        "value": "user_logout"
      },
      {
        "field": "user.name"
      }
    ],
    "relationships": [
      {
        "source": "user.name",
        "target": "host.name",
        "type": "logged out from"
      }
    ]
  },
  {
    "value": "SELinux context: Process with context {linux.audit.process.selinux.context} executed {process.executable} on {host.name}",
    "conditions": [
      {
        "field": "linux.audit.process.selinux.context"
      },
      {
        "field": "process.executable"
      }
    ],
    "relationships": [
      {
        "source": "process.executable",
        "target": "host.name",
        "type": "ran with SELinux context on"
      }
    ]
  },
  {
    "value": "Outbound network connection: {process.executable} connected from {source.ip}:{source.port} to {destination.ip}:{destination.port} on {host.name}",
    "conditions": [
      {
        "field": "network.direction",
        "value": "outbound"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "destination.ip"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "connected to"
      },
      {
        "source": "process.executable",
        "target": "destination.ip",
        "type": "initiated connection to"
      }
    ]
  },
  {
    "value": "Inbound network connection: {process.executable} received connection from {source.ip}:{source.port} to {destination.ip}:{destination.port} on {host.name}",
    "conditions": [
      {
        "field": "network.direction",
        "value": "inbound"
      },
      {
        "field": "source.ip"
      },
      {
        "field": "destination.ip"
      }
    ],
    "relationships": [
      {
        "source": "source.ip",
        "target": "destination.ip",
        "type": "connected to"
      },
      {
        "source": "process.executable",
        "target": "source.ip",
        "type": "received connection from"
      }
    ]
  },
  {
    "value": "Audit event type {event.type} on {host.name} (Sequence: {event.sequence})",
    "conditions": [
      {
        "field": "event.type"
      }
    ]
  }
]
